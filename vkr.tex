\input{header.tex}

\usepackage{caption}
\usepackage{listings}

\DeclareCaptionFont{white}{ \color{white} }
\DeclareCaptionFormat{listing}{
    \parbox{\textwidth}{\hspace{15pt}#1#2#3}
}
\captionsetup[lstlisting]{ format=listing
  %, labelfont=white, textfont=white
  , singlelinecheck=false, margin=0pt, font={bf}
}

\graphicspath{ {images/} }

\begin{document}
\input{title.tex}
\maketitle
\setcounter{tocdepth}{2}
\tableofcontents

\section*{Введение}
\input{intro.tex}

\section*{Постановка задачи}
\label{sec:task}
\input{task.tex}

\section{Обзор}
\input{related.tex}

\section{Алгоритм выделения линейных подпространств, соответствующих семантикам изображения}
\emph{Здесь будет расписан алгоритм выделения семантик, лежащий в основе решения.}

Для выделения семантик изображения принимается предположение о линейности латентного пространства.

Рассмотрим произвольный бинарный признак, заданный дискриминативной функцией $f : \mathcal X \mapsto \{0,1\}$, определяющей наличие или отсутствие этого признака на изображении.
При справедливости этого предположения линейная интерполяция между двумя латентными векторами, соответствующими двум изображениям, на одном из которых признак присутствует, а на другом --- отсутствует, приведет к постепенному и непрерывному изменению этого признака на генерируемом изображении. 

Как показано в \cite{StyleGAN}, линейная разделимость бинарных признаков в промежуточном латентном пространстве $\mathcal{W}$ позволяет найти векторы направлений, соответствующих отдельным факторам вариации, т.е. отдельным признакам.

Для нахождения данных направлений используется следующий метод.
\begin{itemize}
    \item В качестве функции $f$ используется нейросетевой классификатор, обученный на датасете CelebA-HQ. Архитектура крассификатора аналогична архитектуре дискриминатора, используемого в \cite{progressive-growing-gan, StyleGAN}. В качестве рассматриваемых признаков были выбраны \emph{наличие улыбки} и \emph{поворот головы}.
    \item С помощью имеющегося генератора $G$ генерируется набор данных, состоящий из $20000$ изображений. Данный набор размечается с помощью классификатора $f$.
    \item На полученном наборе данных обучается линейная SVM \cite{svm} и находится оптимальная разделяющая гиперплоскость. 
\end{itemize}
Нормальный вектор полученной гиперплоскости задает направление, соответствующее рассматриваемому признаку.
%\subsection{Генерация данных}
%\subsection{Оптимальная разделяющая гиперплоскость}
%\subsection{Линейная разделимость в латентном пространстве}

\begin{figure}[h]
\begin{center}
    \includegraphics[width=0.7\textwidth]{boundary-SVM}
    \caption{Иллюстрация процесса нахождения векторов направлений, соответствующих отдельным факторам вариации, путем нахожения оптимальной разделяющей плоскости.}
    \label{fig:svm-boundary}
\end{center}
\end{figure}

\section{Архитектура решения}
\input{architecture.tex}

\section{Особенности реализации}
\input{implementation.tex}

\section{Эксперименты}
\input{experiments}

\section*{Заключение}
\input{conclusion.tex}

% \nocite{*}
\setmonofont[Mapping=tex-text]{CMU Typewriter Text}
\bibliographystyle{ugost2008ls}
\bibliography{vkr}
\end{document}
